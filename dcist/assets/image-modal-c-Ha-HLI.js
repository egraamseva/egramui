import{c as D,r as c,j as e,B as m,X as tt,R as et}from"./index-B5GP4ZU0.js";import{D as st,a as nt}from"./dialog-D8fBtqfZ.js";const ot=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],lt=D("rotate-cw",ot);const at=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ct=D("zoom-in",at);const it=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ht=D("zoom-out",it);function ut({isOpen:g,onClose:R,imageUrl:E,alt:B="Image",images:i,currentIndex:a=0,onIndexChange:f}){const[o,r]=c.useState(1),[u,x]=c.useState({x:0,y:0}),[$,M]=c.useState(0),[L,S]=c.useState(!1),[X,W]=c.useState({x:0,y:0}),[C,w]=c.useState(null),[Z,y]=c.useState(null),z=c.useRef(null),b=c.useRef(null),l=1,p=5,v=.5;c.useEffect(()=>{g&&(r(1),x({x:0,y:0}),M(0),w(null),y(null))},[g,E]);const K=()=>{r(t=>Math.min(t+v,p))},q=()=>{r(t=>{const s=Math.max(t-v,l);return s===l&&x({x:0,y:0}),s})},Y=()=>{r(1),x({x:0,y:0}),M(0)},H=()=>{M(t=>(t+90)%360)},_=(t,s)=>{const n=s.clientX-t.clientX,h=s.clientY-t.clientY;return Math.sqrt(n*n+h*h)},P=(t,s)=>({x:(t.clientX+s.clientX)/2,y:(t.clientY+s.clientY)/2}),T=()=>{if(!b.current)return{width:0,height:0,left:0,top:0};const t=b.current.getBoundingClientRect();return{width:t.width,height:t.height,left:t.left,top:t.top}},A=(t,s)=>{if(!z.current||!b.current)return t;const n=T(),h=z.current,k=h.naturalWidth*s,d=h.naturalHeight*s,j=Math.max(0,(k-n.width)/2),N=Math.max(0,(d-n.height)/2);return{x:Math.max(-j,Math.min(j,t.x)),y:Math.max(-N,Math.min(N,t.y))}},F=t=>{if(t.touches.length===1)S(!0),W({x:t.touches[0].clientX-u.x,y:t.touches[0].clientY-u.y});else if(t.touches.length===2){S(!1);const s=_(t.touches[0],t.touches[1]),n=P(t.touches[0],t.touches[1]);w(s),y(n)}},G=t=>{if(t.preventDefault(),t.touches.length===1&&L&&o>l){const s={x:t.touches[0].clientX-X.x,y:t.touches[0].clientY-X.y};x(A(s,o))}else if(t.touches.length===2){const s=_(t.touches[0],t.touches[1]),n=P(t.touches[0],t.touches[1]);if(C!==null&&Z){const h=s/C,k=Math.max(l,Math.min(p,o*h)),d=T(),j=n.x-d.left-d.width/2,N=n.y-d.top-d.height/2,I={x:u.x-j*(h-1),y:u.y-N*(h-1)};r(k),x(A(I,k))}w(s),y(n)}},J=()=>{S(!1),w(null),y(null)},O=t=>{if(t.ctrlKey||t.metaKey){t.preventDefault();const s=t.deltaY>0?-v:v,n=Math.max(l,Math.min(p,o+s));r(n),n===l&&x({x:0,y:0})}},Q=()=>{o>l?Y():r(2)};c.useEffect(()=>{if(!g||!i||i.length<=1)return;const t=s=>{s.key==="ArrowLeft"&&a>0?f?.(a-1):s.key==="ArrowRight"&&a<i.length-1&&f?.(a+1)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[g,i,a,f]);const V=i?i[a]:E,U=i&&i.length>1;return e.jsx(st,{open:g,onOpenChange:R,children:e.jsx(nt,{className:"max-w-[95vw] max-h-[95vh] w-full h-full p-0 bg-black/95 border-none",onInteractOutside:t=>{o>l&&t.preventDefault()},children:e.jsxs("div",{ref:b,className:"relative w-full h-full flex items-center justify-center overflow-hidden touch-none",onWheel:O,onTouchStart:F,onTouchMove:G,onTouchEnd:J,children:[e.jsx(m,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 sm:top-4 sm:right-4 z-50 bg-black/50 hover:bg-black/70 text-white rounded-full h-8 w-8 sm:h-10 sm:w-10",onClick:R,children:e.jsx(tt,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),e.jsx("div",{className:"absolute top-2 left-2 sm:top-4 sm:left-4 z-50 flex flex-col gap-2 sm:flex-row",children:e.jsxs("div",{className:"flex gap-1 sm:gap-2 bg-black/50 rounded-lg p-1",children:[e.jsx(m,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-7 w-7 sm:h-8 sm:w-8",onClick:q,disabled:o<=l,children:e.jsx(ht,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),e.jsx(m,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-7 w-7 sm:h-8 sm:w-8",onClick:K,disabled:o>=p,children:e.jsx(ct,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),e.jsx(m,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-7 w-7 sm:h-8 sm:w-8",onClick:H,children:e.jsx(lt,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),o>l&&e.jsx(m,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20 h-7 w-7 sm:h-8 sm:w-8 text-xs sm:text-sm",onClick:Y,children:e.jsx("span",{className:"text-xs",children:"Reset"})})]})}),e.jsx("img",{ref:z,src:V,alt:B,className:et("max-w-full max-h-full object-contain select-none",o>l&&"cursor-move"),style:{transform:`translate(${u.x}px, ${u.y}px) scale(${o}) rotate(${$}deg)`,transition:L||C!==null?"none":"transform 0.1s ease-out"},onDoubleClick:Q,draggable:!1}),U&&e.jsxs(e.Fragment,{children:[a>0&&e.jsx(m,{variant:"ghost",size:"icon",className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-50 bg-black/50 hover:bg-black/70 text-white rounded-full h-8 w-8 sm:h-10 sm:w-10",onClick:()=>f?.(a-1),children:e.jsx("span",{className:"text-base sm:text-lg",children:"←"})}),a<i.length-1&&e.jsx(m,{variant:"ghost",size:"icon",className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-50 bg-black/50 hover:bg-black/70 text-white rounded-full h-8 w-8 sm:h-10 sm:w-10",onClick:()=>f?.(a+1),children:e.jsx("span",{className:"text-base sm:text-lg",children:"→"})}),e.jsxs("div",{className:"absolute bottom-2 sm:bottom-4 left-1/2 -translate-x-1/2 z-50 bg-black/50 rounded-full px-2 py-1 sm:px-3 sm:py-1 text-white text-xs sm:text-sm",children:[a+1," / ",i.length]})]}),o>l&&e.jsxs("div",{className:"absolute bottom-2 sm:bottom-4 right-2 sm:right-4 z-50 bg-black/50 rounded-full px-2 py-1 sm:px-3 sm:py-1 text-white text-xs sm:text-sm",children:[Math.round(o*100),"%"]})]})})})}export{ut as I};
