import{c as Z,a as Ge,r as C,j as e,B as V,X as be,C as je,d as Oe,e as Be,b as Ae,aC as ve,aB as fe,t as G}from"./index-B5GP4ZU0.js";import{I as v}from"./input-C4RtHFee.js";import{L as c}from"./label-k4a1c30R.js";import{T as he}from"./textarea-DqFXOEs1.js";import{C as ae}from"./checkbox-sHSxgcd9.js";import{S as X,a as _,b as z,c as Y,d as f,C as $e,e as Xe}from"./select-dEcH2o1V.js";import{I as _e}from"./images-DNiRzA5N.js";import{L as ze}from"./list-CUSQgfHx.js";import{T as Le,a as Fe,b as le,c as re}from"./tabs-C4k9DC07.js";import{I as Te,v as ie,f as Re,c as Ie}from"./ImageWithFallback-CPTj3iC7.js";import{U as Ne}from"./upload-wi-AKsz6.js";import{P as ge}from"./plus-BdOJHdON.js";import{T as Ce}from"./trash-2-Dvt3QX8d.js";import{m as We}from"./DynamicSectionRenderer-DnALxJmT.js";const Ye=[["path",{d:"M22 7.7c0-.6-.4-1.2-.8-1.5l-6.3-3.9a1.72 1.72 0 0 0-1.7 0l-10.3 6c-.5.2-.9.8-.9 1.4v6.6c0 .5.4 1.2.8 1.5l6.3 3.9a1.72 1.72 0 0 0 1.7 0l10.3-6c.5-.3.9-1 .9-1.5Z",key:"1t2lqe"}],["path",{d:"M10 21.9V14L2.1 9.1",key:"o7czzq"}],["path",{d:"m10 14 11.9-6.9",key:"zm5e20"}],["path",{d:"M14 19.8v-8.1",key:"159ecu"}],["path",{d:"M18 17.5V9.4",key:"11uown"}]],Qe=Z("container",Ye);const Je=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ka=Z("copy",Je);const Ke=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Ze=Z("grid-3x3",Ke);const ea=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],aa=Z("grip-vertical",ea);const ta=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],sa=Z("layout-grid",ta);const la=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],ra=Z("maximize-2",la);const ia=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}]],na=Z("rows-2",ia);const oa=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],da=Z("scroll",oa);const ca=[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]],ua=Z("split",ca);function Se(a,s){if(!a||!s)return;const n=s.split(".");let T=a;for(const E of n){if(T==null)return;T=T[E]}return T}function ye(a,s,n){if(!s)return a;const T=s.split("."),E={...a};let r=E;for(let x=0;x<T.length-1;x++){const L=T[x];!r[L]||typeof r[L]!="object"?r[L]={}:r[L]={...r[L]},r=r[L]}return r[T[T.length-1]]=n,E}function Ee(a){if(a.defaultValue!==void 0&&a.defaultValue!==null){if(a.type==="NUMBER")return parseFloat(String(a.defaultValue))||0;if(a.type==="BOOLEAN"){const s=String(a.defaultValue).toLowerCase();return s==="true"||s==="1"}return a.defaultValue}switch(a.type){case"NUMBER":return 0;case"BOOLEAN":return!1;case"ARRAY":return[];case"GROUP":return{};default:return""}}function pa(a,s){if(a.required&&(s==null||s===""))return{isValid:!1,error:`${a.label} is required`};if(!a.validationRules||s===void 0||s===null||s==="")return{isValid:!0};for(const n of a.validationRules)switch(n.ruleType){case"MIN_LENGTH":if(typeof s=="string"&&s.length<parseInt(n.ruleValue))return{isValid:!1,error:n.errorMessage||`${a.label} must be at least ${n.ruleValue} characters`};break;case"MAX_LENGTH":if(typeof s=="string"&&s.length>parseInt(n.ruleValue))return{isValid:!1,error:n.errorMessage||`${a.label} cannot exceed ${n.ruleValue} characters`};break;case"MIN":if(typeof s=="number"&&s<parseFloat(n.ruleValue))return{isValid:!1,error:n.errorMessage||`${a.label} must be at least ${n.ruleValue}`};break;case"MAX":if(typeof s=="number"&&s>parseFloat(n.ruleValue))return{isValid:!1,error:n.errorMessage||`${a.label} cannot exceed ${n.ruleValue}`};break;case"REGEX":const T=new RegExp(n.ruleValue);if(typeof s=="string"&&!T.test(s))return{isValid:!1,error:n.errorMessage||`${a.label} format is invalid`};break}return{isValid:!0}}function ma(a,s){if(!a.conditionalLogic||a.conditionalLogic.length===0)return!0;for(const n of a.conditionalLogic){const T=Se(s,n.controllingField),E=n.operator==="EQUALS"?String(T)===n.value:String(T)!==n.value;if(E&&n.action==="SHOW")return!0;if(E&&n.action==="HIDE")return!1}return!0}function R(a,s){return a.renderingHints[s]===!0}function Me(a,s){const n=a.config||{};return s?n.availableForPlatform!==!1:n.availableForPanchayat!==!1}const He=[{id:11,schemaType:"HERO_BANNER",name:"Hero Banner",description:"Full-width hero section with title, subtitle, background image, and call-to-action buttons",category:"Hero & Banners",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"title",name:"title",type:"TEXT",label:"Title",required:!0,placeholder:"Enter main heading",displayOrder:1,validationRules:[{ruleType:"MIN_LENGTH",ruleValue:"3",errorMessage:"Title must be at least 3 characters"},{ruleType:"MAX_LENGTH",ruleValue:"200",errorMessage:"Title cannot exceed 200 characters"}]},{id:"subtitle",name:"subtitle",type:"TEXT",label:"Subtitle",required:!1,placeholder:"Enter supporting text",displayOrder:2,validationRules:[{ruleType:"MAX_LENGTH",ruleValue:"500",errorMessage:"Subtitle cannot exceed 500 characters"}]},{id:"backgroundImage",name:"backgroundImage",type:"IMAGE",label:"Background Image",required:!1,placeholder:"Upload background image",displayOrder:3},{id:"ctaPrimary",name:"ctaPrimary",type:"GROUP",label:"Primary Call-to-Action",required:!1,displayOrder:4,nestedFields:[{id:"ctaPrimaryText",name:"text",type:"TEXT",label:"Button Text",required:!1,placeholder:"Get Started",displayOrder:1},{id:"ctaPrimaryLink",name:"link",type:"URL",label:"Button Link",required:!1,placeholder:"/page or https://...",displayOrder:2},{id:"ctaPrimaryStyle",name:"style",type:"SELECT",label:"Button Style",options:[{label:"Primary",value:"primary"},{label:"Secondary",value:"secondary"},{label:"Outline",value:"outline"}],required:!1,defaultValue:"primary",displayOrder:3}]},{id:"ctaSecondary",name:"ctaSecondary",type:"GROUP",label:"Secondary Call-to-Action",required:!1,displayOrder:5,nestedFields:[{id:"ctaSecondaryText",name:"text",type:"TEXT",label:"Button Text",required:!1,placeholder:"Learn More",displayOrder:1},{id:"ctaSecondaryLink",name:"link",type:"URL",label:"Button Link",required:!1,placeholder:"/page or https://...",displayOrder:2}]}],supportedLayouts:["FULL_WIDTH","CONTAINED"],defaultLayout:"FULL_WIDTH",renderingHints:{component:"HeroBanner",supportsCTA:!0,supportsTitle:!0,supportsSpacing:!0,supportsSubtitle:!0,supportsAnimation:!0,supportsBackground:!0,supportsSingleImage:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:2,schemaType:"CARD_SECTION",name:"Card Section",description:"Flexible card-based content section with customizable card layouts",category:"Cards & Grids",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"Cards",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"itemTitle",name:"title",type:"TEXT",label:"Card Title",required:!0,displayOrder:1},{id:"itemDescription",name:"description",type:"RICHTEXT",label:"Card Description",required:!1,displayOrder:2},{id:"itemImage",name:"image",type:"IMAGE",label:"Card Image",required:!1,displayOrder:3},{id:"itemLink",name:"link",type:"URL",label:"Card Link",required:!1,displayOrder:4}]},{id:"columns",name:"columns",type:"NUMBER",label:"Number of Columns",required:!1,defaultValue:"3",displayOrder:2}],supportedLayouts:["GRID","ROW","CAROUSEL","MASONRY"],defaultLayout:"GRID",renderingHints:{component:"CardSection",supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,supportsSubtitle:!0,supportsBackground:!0,supportsMultipleImages:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:6,schemaType:"PARAGRAPH_CONTENT",name:"Paragraph Content",description:"Rich text content section with HTML formatting support for paragraphs, headings, lists, and more",category:"Content",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"richText",name:"richText",type:"RICHTEXT",label:"Content",required:!1,placeholder:"Enter your content here...",displayOrder:1}],supportedLayouts:["FULL_WIDTH","CONTAINED"],defaultLayout:"CONTAINED",renderingHints:{component:"RichTextSection",supportsTitle:!0,supportsSpacing:!0,supportsRichText:!0,supportsSubtitle:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:10,schemaType:"FEATURES_GRID",name:"Features Grid",description:"Grid layout for displaying features, services, or key highlights with icons",category:"Cards & Grids",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"Features",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"itemTitle",name:"title",type:"TEXT",label:"Feature Title",required:!0,displayOrder:1},{id:"itemDescription",name:"description",type:"RICHTEXT",label:"Feature Description",required:!1,displayOrder:2},{id:"itemIcon",name:"icon",type:"TEXT",label:"Icon Name",required:!1,placeholder:"star, check, arrow-right",displayOrder:3},{id:"itemImage",name:"image",type:"IMAGE",label:"Feature Image",required:!1,displayOrder:4},{id:"itemLink",name:"link",type:"URL",label:"Feature Link",required:!1,displayOrder:5}]},{id:"columns",name:"columns",type:"NUMBER",label:"Number of Columns",required:!1,defaultValue:"3",displayOrder:2}],supportedLayouts:["GRID","ROW","CAROUSEL"],defaultLayout:"GRID",renderingHints:{component:"FeaturesGrid",supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,supportsSubtitle:!0,supportsBackground:!0,supportsMultipleImages:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:12,schemaType:"CONTENT_SECTION",name:"Content Section",description:"Rich text content section with HTML formatting support for paragraphs, headings, lists, and more",category:"Content",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"richText",name:"richText",type:"RICHTEXT",label:"Content",required:!0,placeholder:"Enter your content here...",displayOrder:1},{id:"textAlignment",name:"textAlignment",type:"SELECT",label:"Text Alignment",options:[{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"},{label:"Justify",value:"justify"}],required:!1,defaultValue:"left",displayOrder:2},{id:"maxWidth",name:"maxWidth",type:"SELECT",label:"Content Width",options:[{label:"Full Width",value:"full"},{label:"Contained",value:"contained"},{label:"Narrow",value:"narrow"}],required:!1,defaultValue:"contained",displayOrder:3}],supportedLayouts:["FULL_WIDTH","CONTAINED"],defaultLayout:"CONTAINED",renderingHints:{component:"ContentSection",supportsTitle:!0,supportsSpacing:!0,supportsRichText:!0,supportsSubtitle:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:13,schemaType:"IMAGE_WITH_TEXT",name:"Image with Text",description:"Section with image and accompanying text content, perfect for feature highlights",category:"Content",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"image",name:"image",type:"IMAGE",label:"Image",required:!0,displayOrder:1},{id:"imagePosition",name:"imagePosition",type:"SELECT",label:"Image Position",options:[{label:"Left",value:"left"},{label:"Right",value:"right"},{label:"Top",value:"top"},{label:"Bottom",value:"bottom"}],required:!1,defaultValue:"left",displayOrder:2},{id:"title",name:"title",type:"TEXT",label:"Title",required:!1,placeholder:"Enter title",displayOrder:3},{id:"content",name:"content",type:"RICHTEXT",label:"Content",required:!1,placeholder:"Enter content...",displayOrder:4},{id:"cta",name:"cta",type:"GROUP",label:"Call-to-Action",required:!1,displayOrder:5,nestedFields:[{id:"ctaText",name:"text",type:"TEXT",label:"Button Text",required:!1,displayOrder:1},{id:"ctaLink",name:"link",type:"URL",label:"Button Link",required:!1,displayOrder:2}]}],supportedLayouts:["SPLIT","FULL_WIDTH","CONTAINED"],defaultLayout:"SPLIT",renderingHints:{component:"ImageWithText",supportsCTA:!0,supportsTitle:!0,supportsSpacing:!0,supportsRichText:!0,supportsSubtitle:!0,supportsBackground:!0,supportsSingleImage:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:14,schemaType:"IMAGE_GALLERY",name:"Image Gallery",description:"Photo gallery with grid, masonry, or carousel layout options",category:"Media",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"Gallery Items",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"itemImage",name:"image",type:"IMAGE",label:"Image",required:!0,displayOrder:1},{id:"itemTitle",name:"title",type:"TEXT",label:"Title",required:!1,placeholder:"Image title",displayOrder:2},{id:"itemDescription",name:"description",type:"TEXT",label:"Description",required:!1,placeholder:"Image description",displayOrder:3},{id:"itemLink",name:"link",type:"URL",label:"Link",required:!1,placeholder:"Optional link URL",displayOrder:4}]},{id:"columns",name:"columns",type:"NUMBER",label:"Number of Columns",required:!1,defaultValue:"3",displayOrder:2,validationRules:[{ruleType:"MIN",ruleValue:"1"},{ruleType:"MAX",ruleValue:"6"}]},{id:"imageSpacing",name:"imageSpacing",type:"SELECT",label:"Image Spacing",options:[{label:"None",value:"none"},{label:"Small",value:"small"},{label:"Medium",value:"medium"},{label:"Large",value:"large"}],required:!1,defaultValue:"medium",displayOrder:3},{id:"enableLightbox",name:"enableLightbox",type:"BOOLEAN",label:"Enable Lightbox",required:!1,defaultValue:"true",displayOrder:4}],supportedLayouts:["GRID","MASONRY","CAROUSEL"],defaultLayout:"GRID",renderingHints:{component:"ImageGallery",supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,supportsSubtitle:!0,supportsBackground:!0,supportsMultipleImages:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:15,schemaType:"VIDEO_SECTION",name:"Video Section",description:"Embedded video section supporting YouTube, Vimeo, or direct video URLs",category:"Media",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"videoUrl",name:"videoUrl",type:"URL",label:"Video URL",required:!0,placeholder:"https://www.youtube.com/watch?v=... or https://vimeo.com/... or direct video URL",displayOrder:1,validationRules:[{ruleType:"REGEX",ruleValue:"^(https?:\\/\\/)?(www\\.)?(youtube\\.com|youtu\\.be|vimeo\\.com|.*\\.(mp4|webm|ogg|mov))",errorMessage:"Please enter a valid video URL (YouTube, Vimeo, or direct video link)"}]},{id:"thumbnailImage",name:"thumbnailImage",type:"IMAGE",label:"Thumbnail Image",required:!1,placeholder:"Custom thumbnail (optional, only for direct video URLs)",displayOrder:2},{id:"videoSettings",name:"videoSettings",type:"GROUP",label:"Video Settings",required:!1,displayOrder:3,nestedFields:[{id:"autoplay",name:"autoplay",type:"BOOLEAN",label:"Autoplay",required:!1,defaultValue:"false",displayOrder:1},{id:"loop",name:"loop",type:"BOOLEAN",label:"Loop",required:!1,defaultValue:"false",displayOrder:2},{id:"showControls",name:"showControls",type:"BOOLEAN",label:"Show Controls",required:!1,defaultValue:"true",displayOrder:3},{id:"muted",name:"muted",type:"BOOLEAN",label:"Muted",required:!1,defaultValue:"false",displayOrder:4}]},{id:"title",name:"title",type:"TEXT",label:"Title",required:!1,placeholder:"Video title",displayOrder:4},{id:"description",name:"description",type:"TEXT",label:"Description",required:!1,placeholder:"Video description",displayOrder:5}],supportedLayouts:["FULL_WIDTH","CONTAINED"],defaultLayout:"CONTAINED",renderingHints:{component:"VideoSection",supportsTitle:!0,supportsVideo:!0,supportsSpacing:!0,supportsSubtitle:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:16,schemaType:"CARD_GRID",name:"Card Grid",description:"Flexible card-based content section with customizable card layouts",category:"Cards & Grids",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"Cards",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"itemTitle",name:"title",type:"TEXT",label:"Card Title",required:!0,displayOrder:1,validationRules:[{ruleType:"MIN_LENGTH",ruleValue:"1",errorMessage:"Title is required"}]},{id:"itemSubtitle",name:"subtitle",type:"TEXT",label:"Card Subtitle",required:!1,displayOrder:2},{id:"itemDescription",name:"description",type:"RICHTEXT",label:"Card Description",required:!1,displayOrder:3},{id:"itemImage",name:"image",type:"IMAGE",label:"Card Image",required:!1,displayOrder:4},{id:"itemIcon",name:"icon",type:"TEXT",label:"Icon Name",required:!1,placeholder:"Icon identifier (e.g., star, user, building)",displayOrder:5},{id:"itemLink",name:"link",type:"URL",label:"Card Link",required:!1,displayOrder:6},{id:"itemMetadata",name:"metadata",type:"TEXT",label:"Additional Metadata",required:!1,placeholder:"Optional JSON metadata",displayOrder:7}]},{id:"columns",name:"columns",type:"NUMBER",label:"Number of Columns",required:!1,defaultValue:"3",displayOrder:2,validationRules:[{ruleType:"MIN",ruleValue:"1"},{ruleType:"MAX",ruleValue:"6"}]},{id:"cardStyle",name:"cardStyle",type:"SELECT",label:"Card Style",options:[{label:"Default",value:"default"},{label:"Elevated",value:"elevated"},{label:"Outlined",value:"outlined"},{label:"Minimal",value:"minimal"}],required:!1,defaultValue:"default",displayOrder:3}],supportedLayouts:["GRID","ROW","CAROUSEL","MASONRY"],defaultLayout:"GRID",renderingHints:{component:"CardGrid",supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,itemSupportsIcon:!0,itemSupportsLink:!0,supportsSubtitle:!0,itemSupportsImage:!0,supportsBackground:!0,supportsMultipleImages:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:17,schemaType:"STATISTICS_SECTION",name:"Statistics Section",description:"Display statistics and metrics with icons and animated counters",category:"Cards & Grids",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"Statistics",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"statValue",name:"value",type:"TEXT",label:"Value",required:!0,placeholder:"500+",displayOrder:1},{id:"statLabel",name:"label",type:"TEXT",label:"Label",required:!0,placeholder:"Active Users",displayOrder:2},{id:"statIcon",name:"icon",type:"TEXT",label:"Icon Name",required:!1,placeholder:"trending-up, users, building, etc.",displayOrder:3},{id:"statDescription",name:"description",type:"TEXT",label:"Description",required:!1,placeholder:"Optional description",displayOrder:4}]},{id:"columns",name:"columns",type:"NUMBER",label:"Number of Columns",required:!1,defaultValue:"4",displayOrder:2,validationRules:[{ruleType:"MIN",ruleValue:"1"},{ruleType:"MAX",ruleValue:"6"}]},{id:"enableAnimation",name:"enableAnimation",type:"BOOLEAN",label:"Enable Counter Animation",required:!1,defaultValue:"true",displayOrder:3}],supportedLayouts:["GRID","ROW"],defaultLayout:"GRID",renderingHints:{component:"StatisticsSection",supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,itemSupportsIcon:!0,supportsSubtitle:!0,itemSupportsValue:!0,supportsAnimation:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:18,schemaType:"FAQ_SECTION",name:"FAQ Section",description:"Expandable FAQ section with questions and answers in accordion format",category:"Interactive",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"FAQ Items",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"faqQuestion",name:"question",type:"TEXT",label:"Question",required:!0,placeholder:"Frequently asked question",displayOrder:1,validationRules:[{ruleType:"MIN_LENGTH",ruleValue:"5",errorMessage:"Question must be at least 5 characters"}]},{id:"faqAnswer",name:"answer",type:"RICHTEXT",label:"Answer",required:!0,placeholder:"Answer to the question",displayOrder:2},{id:"faqCategory",name:"category",type:"TEXT",label:"Category",required:!1,placeholder:"Optional category",displayOrder:3}]},{id:"allowMultipleOpen",name:"allowMultipleOpen",type:"BOOLEAN",label:"Allow Multiple Items Open",required:!1,defaultValue:"false",displayOrder:2},{id:"defaultOpenFirst",name:"defaultOpenFirst",type:"BOOLEAN",label:"Open First Item by Default",required:!1,defaultValue:"false",displayOrder:3}],supportedLayouts:["LIST","GRID"],defaultLayout:"LIST",renderingHints:{component:"FAQSection",supportsFAQ:!0,supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,supportsSubtitle:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:19,schemaType:"FORM_SECTION",name:"Form Section",description:"Contact or feedback form with customizable fields and validation",category:"Interactive",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"formFields",name:"formFields",type:"ARRAY",label:"Form Fields",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"fieldType",name:"type",type:"SELECT",label:"Field Type",options:[{label:"Text",value:"text"},{label:"Email",value:"email"},{label:"Phone",value:"phone"},{label:"Textarea",value:"textarea"},{label:"Select",value:"select"},{label:"Checkbox",value:"checkbox"},{label:"Radio",value:"radio"},{label:"Date",value:"date"},{label:"Number",value:"number"}],required:!0,displayOrder:1},{id:"fieldLabel",name:"label",type:"TEXT",label:"Field Label",required:!0,displayOrder:2},{id:"fieldPlaceholder",name:"placeholder",type:"TEXT",label:"Placeholder",required:!1,displayOrder:3},{id:"fieldRequired",name:"required",type:"BOOLEAN",label:"Required",required:!1,defaultValue:"false",displayOrder:4},{id:"fieldOptions",name:"options",type:"TEXT",label:"Options (comma-separated, for select/radio)",required:!1,placeholder:"Option 1, Option 2, Option 3",displayOrder:5}]},{id:"submitButtonText",name:"submitButtonText",type:"TEXT",label:"Submit Button Text",required:!1,defaultValue:"Submit",displayOrder:2},{id:"formAction",name:"formAction",type:"URL",label:"Form Action URL",required:!1,placeholder:"/api/submit-form or https://...",displayOrder:3},{id:"successMessage",name:"successMessage",type:"TEXT",label:"Success Message",required:!1,defaultValue:"Thank you! Your submission has been received.",displayOrder:4}],supportedLayouts:["CONTAINED","FULL_WIDTH"],defaultLayout:"CONTAINED",renderingHints:{component:"FormSection",supportsForm:!0,supportsTitle:!0,supportsSpacing:!0,supportsSubtitle:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:20,schemaType:"TESTIMONIALS_SECTION",name:"Testimonials Section",description:"Customer testimonials and reviews with ratings and author information",category:"Interactive",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"Testimonials",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"testimonialText",name:"text",type:"RICHTEXT",label:"Testimonial Text",required:!0,displayOrder:1},{id:"testimonialAuthor",name:"author",type:"TEXT",label:"Author Name",required:!0,displayOrder:2},{id:"testimonialRole",name:"role",type:"TEXT",label:"Author Role/Title",required:!1,displayOrder:3},{id:"testimonialImage",name:"image",type:"IMAGE",label:"Author Image",required:!1,displayOrder:4},{id:"testimonialRating",name:"rating",type:"NUMBER",label:"Rating (1-5)",required:!1,defaultValue:"5",displayOrder:5,validationRules:[{ruleType:"MIN",ruleValue:"1"},{ruleType:"MAX",ruleValue:"5"}]},{id:"testimonialCompany",name:"company",type:"TEXT",label:"Company/Organization",required:!1,displayOrder:6}]},{id:"columns",name:"columns",type:"NUMBER",label:"Number of Columns",required:!1,defaultValue:"3",displayOrder:2,validationRules:[{ruleType:"MIN",ruleValue:"1"},{ruleType:"MAX",ruleValue:"4"}]},{id:"showRatings",name:"showRatings",type:"BOOLEAN",label:"Show Star Ratings",required:!1,defaultValue:"true",displayOrder:3}],supportedLayouts:["GRID","CAROUSEL","ROW"],defaultLayout:"GRID",renderingHints:{component:"TestimonialsSection",supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,supportsSubtitle:!0,itemSupportsImage:!0,itemSupportsRating:!0,supportsBackground:!0,supportsTestimonials:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:21,schemaType:"TIMELINE_SECTION",name:"Timeline Section",description:"Chronological timeline displaying events, milestones, or development history",category:"Interactive",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"Timeline Items",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"timelineTitle",name:"title",type:"TEXT",label:"Event Title",required:!0,displayOrder:1},{id:"timelineDate",name:"date",type:"DATE",label:"Date",required:!1,displayOrder:2},{id:"timelineDescription",name:"description",type:"RICHTEXT",label:"Description",required:!1,displayOrder:3},{id:"timelineImage",name:"image",type:"IMAGE",label:"Image",required:!1,displayOrder:4},{id:"timelineIcon",name:"icon",type:"TEXT",label:"Icon Name",required:!1,placeholder:"calendar, clock, check, etc.",displayOrder:5}]},{id:"timelineOrientation",name:"timelineOrientation",type:"SELECT",label:"Timeline Orientation",options:[{label:"Vertical",value:"vertical"},{label:"Horizontal",value:"horizontal"}],required:!1,defaultValue:"vertical",displayOrder:2},{id:"showDates",name:"showDates",type:"BOOLEAN",label:"Show Dates",required:!1,defaultValue:"true",displayOrder:3}],supportedLayouts:["LIST","FULL_WIDTH"],defaultLayout:"LIST",renderingHints:{component:"TimelineSection",supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,itemSupportsIcon:!0,supportsSubtitle:!0,supportsTimeline:!0,itemSupportsImage:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:22,schemaType:"CALL_TO_ACTION",name:"Call to Action",description:"Prominent call-to-action section with buttons and compelling messaging",category:"Specialized",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"title",name:"title",type:"TEXT",label:"Title",required:!0,placeholder:"Compelling headline",displayOrder:1},{id:"subtitle",name:"subtitle",type:"TEXT",label:"Subtitle",required:!1,placeholder:"Supporting text",displayOrder:2},{id:"content",name:"content",type:"RICHTEXT",label:"Content",required:!1,placeholder:"Additional content",displayOrder:3},{id:"primaryCTA",name:"primaryCTA",type:"GROUP",label:"Primary Button",required:!0,displayOrder:4,nestedFields:[{id:"primaryCTAText",name:"text",type:"TEXT",label:"Button Text",required:!0,displayOrder:1},{id:"primaryCTALink",name:"link",type:"URL",label:"Button Link",required:!0,displayOrder:2},{id:"primaryCTAStyle",name:"style",type:"SELECT",label:"Button Style",options:[{label:"Primary",value:"primary"},{label:"Secondary",value:"secondary"},{label:"Outline",value:"outline"}],required:!1,defaultValue:"primary",displayOrder:3}]},{id:"secondaryCTA",name:"secondaryCTA",type:"GROUP",label:"Secondary Button",required:!1,displayOrder:5,nestedFields:[{id:"secondaryCTAText",name:"text",type:"TEXT",label:"Button Text",required:!1,displayOrder:1},{id:"secondaryCTALink",name:"link",type:"URL",label:"Button Link",required:!1,displayOrder:2}]}],supportedLayouts:["FULL_WIDTH","CONTAINED"],defaultLayout:"CONTAINED",renderingHints:{component:"CallToAction",supportsCTA:!0,supportsTitle:!0,supportsSpacing:!0,supportsRichText:!0,supportsSubtitle:!0,supportsAnimation:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:23,schemaType:"CONTACT_INFO",name:"Contact Information",description:"Contact details section with address, phone, email, and office hours",category:"Specialized",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"Contact Methods",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"contactType",name:"type",type:"SELECT",label:"Contact Type",options:[{label:"Phone",value:"phone"},{label:"Email",value:"email"},{label:"Address",value:"address"},{label:"Office Hours",value:"hours"},{label:"Social Media",value:"social"},{label:"Other",value:"other"}],required:!0,displayOrder:1},{id:"contactLabel",name:"label",type:"TEXT",label:"Label",required:!0,placeholder:"Phone, Email, Address, etc.",displayOrder:2},{id:"contactValue",name:"value",type:"TEXT",label:"Value",required:!0,placeholder:"Contact information",displayOrder:3},{id:"contactIcon",name:"icon",type:"TEXT",label:"Icon Name",required:!1,placeholder:"phone, mail, map-pin, clock, etc.",displayOrder:4},{id:"contactLink",name:"link",type:"URL",label:"Link",required:!1,placeholder:"Optional link URL",displayOrder:5}]},{id:"showMap",name:"showMap",type:"BOOLEAN",label:"Show Map",required:!1,defaultValue:"false",displayOrder:2},{id:"mapCoordinates",name:"mapCoordinates",type:"TEXT",label:"Map Coordinates (latitude, longitude)",required:!1,placeholder:"22.9734, 78.6569",displayOrder:3,conditionalLogic:[{value:"true",action:"SHOW",operator:"EQUALS",controllingField:"showMap"}]}],supportedLayouts:["GRID","ROW","SPLIT"],defaultLayout:"GRID",renderingHints:{component:"ContactInfo",supportsMap:!0,supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,itemSupportsIcon:!0,itemSupportsLink:!0,supportsSubtitle:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:24,schemaType:"MAP_SECTION",name:"Map Section",description:"Interactive map showing location with custom markers and zoom controls",category:"Specialized",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"coordinates",name:"coordinates",type:"TEXT",label:"Coordinates (latitude, longitude)",required:!0,placeholder:"22.9734, 78.6569",displayOrder:1,validationRules:[{ruleType:"REGEX",ruleValue:"^(-?\\d+\\.?\\d*),\\s*(-?\\d+\\.?\\d*)$",errorMessage:"Please enter coordinates in format: latitude, longitude"}]},{id:"zoomLevel",name:"zoomLevel",type:"NUMBER",label:"Zoom Level",required:!1,defaultValue:"15",displayOrder:2,validationRules:[{ruleType:"MIN",ruleValue:"1"},{ruleType:"MAX",ruleValue:"20"}]},{id:"markerTitle",name:"markerTitle",type:"TEXT",label:"Marker Title",required:!1,placeholder:"Location name",displayOrder:3},{id:"markerDescription",name:"markerDescription",type:"TEXT",label:"Marker Description",required:!1,placeholder:"Location description",displayOrder:4},{id:"mapHeight",name:"mapHeight",type:"NUMBER",label:"Map Height (pixels)",required:!1,defaultValue:"400",displayOrder:5,validationRules:[{ruleType:"MIN",ruleValue:"200"},{ruleType:"MAX",ruleValue:"800"}]},{id:"enableScrollWheel",name:"enableScrollWheel",type:"BOOLEAN",label:"Enable Scroll Wheel Zoom",required:!1,defaultValue:"false",displayOrder:6}],supportedLayouts:["FULL_WIDTH","CONTAINED"],defaultLayout:"FULL_WIDTH",renderingHints:{component:"MapSection",supportsMap:!0,supportsTitle:!0,supportsSpacing:!0,supportsSubtitle:!0,supportsBackground:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}},{id:25,schemaType:"NEWS_FEED",name:"News Feed",description:"News articles, announcements, or blog posts in a feed layout",category:"Specialized",version:1,isActive:!0,isSystem:!0,panchayatId:null,fieldDefinitions:[{id:"items",name:"items",type:"ARRAY",label:"News Items",required:!1,displayOrder:1,isRepeatable:!0,nestedFields:[{id:"newsTitle",name:"title",type:"TEXT",label:"Title",required:!0,displayOrder:1},{id:"newsDate",name:"date",type:"DATE",label:"Date",required:!1,displayOrder:2},{id:"newsAuthor",name:"author",type:"TEXT",label:"Author",required:!1,displayOrder:3},{id:"newsSummary",name:"summary",type:"TEXT",label:"Summary",required:!1,placeholder:"Brief summary",displayOrder:4},{id:"newsContent",name:"content",type:"RICHTEXT",label:"Content",required:!1,displayOrder:5},{id:"newsImage",name:"image",type:"IMAGE",label:"Featured Image",required:!1,displayOrder:6},{id:"newsLink",name:"link",type:"URL",label:"Read More Link",required:!1,displayOrder:7},{id:"newsCategory",name:"category",type:"TEXT",label:"Category",required:!1,displayOrder:8}]},{id:"itemsPerPage",name:"itemsPerPage",type:"NUMBER",label:"Items Per Page",required:!1,defaultValue:"6",displayOrder:2,validationRules:[{ruleType:"MIN",ruleValue:"1"},{ruleType:"MAX",ruleValue:"24"}]},{id:"enablePagination",name:"enablePagination",type:"BOOLEAN",label:"Enable Pagination",required:!1,defaultValue:"true",displayOrder:3},{id:"sortOrder",name:"sortOrder",type:"SELECT",label:"Sort Order",options:[{label:"Newest First",value:"newest"},{label:"Oldest First",value:"oldest"},{label:"Alphabetical",value:"alphabetical"}],required:!1,defaultValue:"newest",displayOrder:4}],supportedLayouts:["GRID","LIST","CAROUSEL"],defaultLayout:"GRID",renderingHints:{component:"NewsFeed",supportsItems:!0,supportsTitle:!0,supportsSpacing:!0,itemSupportsLink:!0,supportsSubtitle:!0,itemSupportsImage:!0,supportsBackground:!0,supportsMultipleImages:!0},config:{requiresAuth:!1,availableForPlatform:!0,availableForPanchayat:!0},i18n:{}}];function ha(a,s){return a.find(n=>n.schemaType===s&&n.isActive)}function ga(a,s){return a.filter(n=>n.category===s&&n.isActive)}function ya(a){return Array.from(new Set(a.filter(s=>s.isActive).map(s=>s.category))).sort()}function xa({value:a,onValueChange:s,isPlatform:n=!1,label:T}){const{t:E}=Ge(),r=T||E("sectionManagement.sectionType"),[x,L]=C.useState([]),[I,q]=C.useState(!0);C.useEffect(()=>{const p=He.filter(g=>Me(g,n)&&g.isActive);L(p),q(!1)},[n]);const A=x.filter(p=>Me(p,n)&&p.isActive),M=ya(A),O=M.reduce((p,g)=>(p[g]=ga(A,g),p),{});if(C.useEffect(()=>{console.log("SectionTypeSelector:",{value:a,availableSchemasCount:A.length,categoriesCount:M.length,groupedSchemasKeys:Object.keys(O),hasValue:!!a,valueInSchemas:A.some(p=>p.schemaType===a)})},[a,A,M,O]),I)return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"section-type",children:[r," *"]}),e.jsx(X,{disabled:!0,children:e.jsx(_,{id:"section-type",className:"w-full",children:e.jsx(z,{placeholder:"Loading section types..."})})})]});const l=A.find(p=>p.schemaType===a),S=a&&!l;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"section-type",children:[r," *"]}),S&&e.jsxs("div",{className:"mb-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800",children:['âš ï¸ Current section type "',a,'" is not in available schemas. You can still edit the content below.']}),e.jsxs(X,{value:a,onValueChange:s,children:[e.jsx(_,{id:"section-type",className:"w-full",children:e.jsx(z,{placeholder:E("sectionManagement.selectSectionType"),children:l?l.name:a||E("sectionManagement.selectSectionType")})}),e.jsx(Y,{className:"max-h-[400px] min-w-[var(--radix-select-trigger-width)] max-w-[min(500px,90vw)]",position:"popper",children:e.jsx("div",{className:"p-1",children:Object.keys(O).length===0?e.jsx("div",{className:"px-3 py-4 text-center text-sm text-muted-foreground",children:"No section types available"}):Object.entries(O).map(([p,g])=>e.jsxs("div",{className:"mb-1 last:mb-0",children:[e.jsx("div",{className:"px-3 py-2 text-xs font-semibold text-muted-foreground uppercase tracking-wider bg-muted/50 rounded-sm mb-1 sticky top-0 z-10 backdrop-blur-sm",children:p}),e.jsx("div",{className:"space-y-0.5",children:g.map(F=>e.jsx(f,{value:F.schemaType,className:"py-2.5 px-3 cursor-pointer rounded-md hover:bg-accent/80 transition-colors min-h-[60px]",children:e.jsxs("div",{className:"flex flex-col gap-1 w-full pr-6",children:[e.jsx("div",{className:"font-medium text-sm leading-tight text-foreground",children:F.name}),e.jsx("div",{className:"text-xs text-muted-foreground leading-relaxed line-clamp-2 break-words",children:F.description})]})},F.schemaType))})]},p))})})]})]})}const ke=[{value:"GRID",label:"Grid",description:"CSS Grid layout with configurable columns",icon:Ze},{value:"ROW",label:"Row",description:"Horizontal flex layout",icon:na},{value:"SCROLLING_ROW",label:"Scrolling Row",description:"Horizontal scrollable container",icon:da},{value:"CAROUSEL",label:"Carousel",description:"Image/content carousel with navigation",icon:_e},{value:"MASONRY",label:"Masonry",description:"Pinterest-style irregular grid layout",icon:sa},{value:"LIST",label:"List",description:"Vertical stacked items list",icon:ze},{value:"SPLIT",label:"Split",description:"Left-right split with image and content",icon:ua},{value:"FULL_WIDTH",label:"Full Width",description:"Edge-to-edge content",icon:ra},{value:"CONTAINED",label:"Contained",description:"Centered with max-width container",icon:Qe}];function va({value:a,onValueChange:s,label:n,supportedLayouts:T}){const{t:E}=Ge(),r=n||E("sectionManagement.layoutType"),x=I=>{const q=I.toLowerCase().replace(/_/g,"");return E(`sectionManagement.layoutTypes.${q}`,{defaultValue:I})},L=T?ke.filter(I=>T.includes(I.value)):ke;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(c,{htmlFor:"layout-type",children:[r," *"]}),e.jsxs(X,{value:a,onValueChange:s,children:[e.jsx(_,{id:"layout-type",className:"w-full",children:e.jsx(z,{placeholder:E("sectionManagement.selectLayoutType")})}),e.jsx(Y,{className:"max-h-[300px]",children:L.map(I=>{const q=I.icon;return e.jsx(f,{value:I.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium",children:x(I.value)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:I.description})]})]})},I.value)})})]})]})}function we({fields:a,content:s,onChange:n,onImageUpload:T,isPlatform:E=!1,sectionType:r=""}){const[x,L]=C.useState({}),I=(l,S)=>{const p=ye(s||{},l,S);n(p),x[l]&&L(g=>{const F={...g};return delete F[l],F})},q=(l,S)=>{const p=pa(l,S);p.isValid||L(g=>({...g,[l.name]:p.error||"Invalid value"}))},A=async(l,S)=>{const p=l.target.files?.[0];if(p&&T)try{const g=await T(p,S.name);g&&I(S.name,g)}catch(g){console.error("Error uploading image:",g)}},M=(l,S=0)=>{if(!ma(l,s))return null;const p=Se(s,l.name),g=x[l.name],F=S>0?`ml-${S*4}`:"";switch(l.type){case"TEXT":return e.jsxs("div",{className:`space-y-2 ${F}`,children:[e.jsxs(c,{htmlFor:l.id,children:[l.label,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(v,{id:l.id,value:p||"",onChange:w=>I(l.name,w.target.value),onBlur:()=>q(l,p),placeholder:l.placeholder||"",className:g?"border-red-500":""}),g&&e.jsx("p",{className:"text-xs text-red-500",children:g})]},l.id);case"RICHTEXT":return e.jsxs("div",{className:`space-y-2 ${F}`,children:[e.jsxs(c,{htmlFor:l.id,children:[l.label,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(he,{id:l.id,value:p||"",onChange:w=>I(l.name,w.target.value),onBlur:()=>q(l,p),placeholder:l.placeholder||"",rows:l.name.includes("description")||l.name.includes("content")?6:3,className:g?"border-red-500":""}),g&&e.jsx("p",{className:"text-xs text-red-500",children:g})]},l.id);case"NUMBER":return e.jsxs("div",{className:`space-y-2 ${F}`,children:[e.jsxs(c,{htmlFor:l.id,children:[l.label,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(v,{id:l.id,type:"number",value:p??Ee(l),onChange:w=>I(l.name,parseFloat(w.target.value)||0),onBlur:()=>q(l,p),placeholder:l.placeholder||"",className:g?"border-red-500":""}),g&&e.jsx("p",{className:"text-xs text-red-500",children:g})]},l.id);case"BOOLEAN":return e.jsxs("div",{className:`flex items-center space-x-2 ${F}`,children:[e.jsx(ae,{id:l.id,checked:p??Ee(l),onCheckedChange:w=>I(l.name,w)}),e.jsxs(c,{htmlFor:l.id,className:"cursor-pointer",children:[l.label,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]},l.id);case"URL":return e.jsxs("div",{className:`space-y-2 ${F}`,children:[e.jsxs(c,{htmlFor:l.id,children:[l.label,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(v,{id:l.id,type:"url",value:p||"",onChange:w=>I(l.name,w.target.value),onBlur:()=>q(l,p),placeholder:l.placeholder||"https://...",className:g?"border-red-500":""}),g&&e.jsx("p",{className:"text-xs text-red-500",children:g})]},l.id);case"IMAGE":return e.jsxs("div",{className:`space-y-2 ${F}`,children:[e.jsxs(c,{children:[l.label,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),p?e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(Te,{src:p,alt:l.label,className:"w-full h-48 rounded-lg object-cover"}),e.jsx(V,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>I(l.name,""),children:e.jsx(be,{className:"h-4 w-4"})})]})}):e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center",children:[e.jsx(Ne,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsxs(c,{htmlFor:`image-${l.id}`,className:"cursor-pointer",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Click to upload image"}),e.jsx(v,{id:`image-${l.id}`,type:"file",accept:"image/*",onChange:w=>A(w,l),className:"hidden"})]})]})]},l.id);case"DATE":return e.jsxs("div",{className:`space-y-2 ${F}`,children:[e.jsxs(c,{htmlFor:l.id,children:[l.label,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(v,{id:l.id,type:"date",value:p||"",onChange:w=>I(l.name,w.target.value),onBlur:()=>q(l,p),className:g?"border-red-500":""}),g&&e.jsx("p",{className:"text-xs text-red-500",children:g})]},l.id);case"SELECT":return e.jsxs("div",{className:`space-y-2 ${F}`,children:[e.jsxs(c,{htmlFor:l.id,children:[l.label,l.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs(X,{value:p||l.defaultValue||"",onValueChange:w=>I(l.name,w),children:[e.jsx(_,{id:l.id,className:g?"border-red-500":"",children:e.jsx(z,{placeholder:l.placeholder||"Select an option"})}),e.jsx(Y,{children:l.options?.map(w=>e.jsx(f,{value:w.value,children:w.label},w.value))})]}),g&&e.jsx("p",{className:"text-xs text-red-500",children:g})]},l.id);case"ARRAY":return e.jsx(fa,{field:l,content:s,onChange:n,onImageUpload:T,depth:S,sectionType:r},l.id);case"GROUP":return e.jsx(ba,{field:l,content:s,onChange:n,onImageUpload:T,depth:S},l.id);default:return null}},O=[...a].sort((l,S)=>(l.displayOrder||0)-(S.displayOrder||0));return e.jsx("div",{className:"space-y-4",children:O.map(l=>M(l,0))})}function fa({field:a,content:s,onChange:n,onImageUpload:T,depth:E,sectionType:r}){const x=Se(s,a.name)||[],[L,I]=C.useState(new Set),q=()=>{if(!a.nestedFields)return;const O={};a.nestedFields.forEach(S=>{O[S.name]=Ee(S)}),O.id=`item-${Date.now()}`;const l=[...x,O];n(ye(s,a.name,l))},A=O=>{const l=x.filter((S,p)=>p!==O);n(ye(s,a.name,l))},M=O=>{const l=new Set(L);l.has(O)?l.delete(O):l.add(O),I(l)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(c,{children:[a.label,a.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a.isRepeatable&&e.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:q,children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Add ",a.label]})]}),x.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground border rounded-lg",children:[e.jsxs("p",{children:["No ",a.label.toLowerCase()," yet"]}),a.isRepeatable&&e.jsxs(V,{type:"button",variant:"outline",size:"sm",onClick:q,className:"mt-2",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Add First ",a.label]})]}):e.jsx("div",{className:"space-y-3",children:x.map((O,l)=>e.jsxs(je,{className:"border-[#E5E5E5]",children:[e.jsx(Oe,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(V,{type:"button",variant:"ghost",size:"sm",onClick:()=>M(l),className:"flex-1 justify-start",children:e.jsxs("span",{className:"font-semibold",children:[a.label," ",l+1,O.title&&e.jsxs("span",{className:"text-muted-foreground ml-2",children:["- ",O.title]})]})}),e.jsx(V,{type:"button",variant:"ghost",size:"sm",onClick:()=>A(l),className:"text-destructive hover:text-destructive",children:e.jsx(Ce,{className:"h-4 w-4"})})]})}),L.has(l)&&a.nestedFields&&e.jsx(Ae,{className:"space-y-4",children:e.jsx(we,{fields:a.nestedFields,content:O,onChange:S=>{const p=[...x];p[l]=S,n(ye(s,a.name,p))},onImageUpload:T?async(S,p)=>{const g=`${a.name}[${l}].${p}`;return console.log(`ðŸ“¸ ArrayFieldRenderer: Wrapping onImageUpload with index ${l}, fieldName=${p}, combined=${g}`),await T(S,g)}:void 0,sectionType:r})})]},O.id||l))})]})}function ba({field:a,content:s,onChange:n,onImageUpload:T,depth:E}){const r=Se(s,a.name)||{};return a.nestedFields?e.jsxs(je,{className:"border-[#E5E5E5]",children:[e.jsx(Oe,{children:e.jsx(Be,{className:"text-base",children:a.label})}),e.jsx(Ae,{className:"space-y-4",children:e.jsx(we,{fields:a.nestedFields,content:r,onChange:x=>n(ye(s,a.name,x)),onImageUpload:T})})]}):null}function qe({sectionType:a,content:s,layoutType:n,isPlatform:T,schema:E,onContentChange:r,onImageUpload:x,onImageRemove:L}){const[I,q]=C.useState("content"),[A,M]=C.useState(s?.items||[]),[O,l]=C.useState(s?.columns||3),[S,p]=C.useState(s?.autoPlay||!1),[g,F]=C.useState(s?.interval||5e3),[w,N]=C.useState(s?.richText||""),[te,D]=C.useState(s?.background||{type:"color",value:"#ffffff"}),[ne,oe]=C.useState(s?.spacing||{}),[de,ce]=C.useState(s?.animation||{type:"none"}),[ue,pe]=C.useState(s?.cta||{text:"Learn More",link:"#",style:"primary",size:"md"}),[d,o]=C.useState(s?.formFields||[]),[b,U]=C.useState(new Set);C.useEffect(()=>{let t=s;if(typeof s=="string")try{t=JSON.parse(s)}catch(y){console.warn("Failed to parse content in SectionContentEditor:",y),t={}}const i=t?.items||[];M(i),l(t?.columns||3),p(t?.autoPlay||!1),F(t?.interval||5e3),N(t?.richText||""),D(t?.background||{type:"color",value:"#ffffff"}),oe(t?.spacing||{}),ce(t?.animation||{type:"none"}),pe(t?.cta||{text:"Learn More",link:"#",style:"primary",size:"md"}),o(t?.formFields||[])},[s]);const m=t=>{let i=s;if(typeof s=="string")try{i=JSON.parse(s)}catch(u){console.warn("Failed to parse content in updateContent:",u),i={}}const y={...i,items:A,columns:O,autoPlay:S,interval:g,richText:w,background:te,spacing:ne,animation:de,cta:ue,formFields:d,...t};r(y)},h=()=>{const t=ee(a),i=[...A,{...t,id:`item-${Date.now()}`}];M(i),m({items:i})},P=t=>{const i=A.filter((y,u)=>u!==t);M(i),m({items:i}),L(t)},j=(t,i,y)=>{const u=[...A];u[t]={...u[t],[i]:y},M(u),m({items:u})},k=(t,i)=>{const y=[...A],[u]=y.splice(t,1);y.splice(i,0,u),M(y),m({items:y})},Q=t=>{const i=new Set(b);i.has(t)?i.delete(t):i.add(t),U(i)};if(E&&E.fieldDefinitions&&E.fieldDefinitions.length>0)return console.log("SectionContentEditor: Using schema-based form builder",{schemaType:E.schemaType,fieldsCount:E.fieldDefinitions.length,hasContent:!!s}),e.jsx("div",{className:"space-y-4",children:e.jsx(we,{fields:E.fieldDefinitions,content:s||{},onChange:r,onImageUpload:async(t,i)=>{let y=-1;const u=i.match(/^(\w+)\[(\d+)\]\.(.+)$/);if(u){const K=u[1];y=parseInt(u[2],10);const me=u[3];if(console.log(`ðŸ“¸ Parsed array field: arrayField=${K}, itemIndex=${y}, nestedField=${me}`),y>=0&&x)return await x(t,y)}else{console.log(`ðŸ“¸ Direct field upload: fieldName=${i}`);try{await ie(t);const K=T?ve:fe;console.log(`ðŸ“¤ Uploading image for direct field "${i}" using generic upload endpoint`);const me=await K.uploadImageGeneric(t,"HIGH");if(me?.imageUrl)return console.log(`âœ… Image uploaded successfully for field "${i}":`,me.imageUrl),me.imageUrl;throw console.error("âŒ Image upload failed: No imageUrl returned"),new Error("Image upload failed: No URL returned")}catch(K){return console.error("âŒ Error uploading image for direct field:",K),G.error(K.message||"Failed to upload image"),null}}return null},isPlatform:T,sectionType:a})});console.log("SectionContentEditor: No schema, using fallback editor",{sectionType:a,hasContent:!!s,itemsCount:s?.items?.length||0});const W=async(t,i)=>{const y=t.target.files?.[0];if(y)try{await ie(y);const u=await x(y,i);u&&j(i,"image",u)}catch(u){console.error("Error preparing item image:",u),t.target.value="",u.message&&console.error("Image validation error:",u.message)}},ee=t=>{switch(t){case"STATS":return{type:"stat",title:"Stat Title",value:"0",label:"Label",icon:"trending-up"};case"FEATURES":case"SCHEMES":case"CARDS":return{type:"card",title:"Card Title",description:"Card description",icon:"star"};case"NEWS":case"ANNOUNCEMENTS":return{type:"card",title:"News Title",subtitle:"Date",description:"News description"};case"GALLERY":case"IMAGE_GALLERY":return{type:"gallery_item",title:"Image Title",description:"Image description"};case"MEMBERS":return{type:"card",title:"Member Name",subtitle:"Position",description:"Member bio"};case"CTA":return{type:"card",title:"CTA Title",description:"CTA description",link:"#"};case"CONTACT":return{type:"card",title:"Contact Method",subtitle:"Label",description:"Contact information"};case"FAQ":return{type:"accordion_item",title:"Question",description:"Answer"};case"TESTIMONIALS":return{type:"testimonial",title:"Citizen Name",subtitle:"Role",description:"Testimonial text",value:"5"};case"TIMELINE":return{type:"timeline_item",title:"Event Title",subtitle:"Date",description:"Event description"};default:return{type:"card",title:"Item Title",subtitle:"Subtitle",description:"Description"}}},H=()=>{const t={id:`field-${Date.now()}`,type:"text",label:"New Field",placeholder:"",required:!1};o([...d,t]),m({formFields:[...d,t]})},J=(t,i)=>{const y=[...d];y[t]={...y[t],...i},o(y),m({formFields:y})},xe=t=>{const i=d.filter((y,u)=>u!==t);o(i),m({formFields:i})},se=(t,i)=>{const y=b.has(i);return e.jsxs(je,{className:"border-[#E5E5E5]",children:[e.jsx(Oe,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(aa,{className:"h-5 w-5 text-muted-foreground cursor-move"}),e.jsxs(V,{type:"button",variant:"ghost",size:"sm",onClick:()=>Q(i),className:"flex-1 justify-start",children:[e.jsxs("span",{className:"font-semibold",children:["Item ",i+1]}),t.title&&e.jsxs("span",{className:"text-muted-foreground ml-2",children:["- ",t.title]}),y?e.jsx($e,{className:"h-4 w-4 ml-auto"}):e.jsx(Xe,{className:"h-4 w-4 ml-auto"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[i>0&&e.jsx(V,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(i,i-1),title:"Move up",children:"â†‘"}),i<A.length-1&&e.jsx(V,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(i,i+1),title:"Move down",children:"â†“"}),e.jsx(V,{type:"button",variant:"ghost",size:"sm",onClick:()=>P(i),className:"text-destructive hover:text-destructive",children:e.jsx(Ce,{className:"h-4 w-4"})})]})]})}),y&&e.jsxs(Ae,{className:"space-y-4",children:[a!=="STATS"&&a!=="FAQ"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Title"}),e.jsx(v,{value:t.title||"",onChange:u=>j(i,"title",u.target.value),placeholder:"Item title"})]}),(a==="NEWS"||a==="ANNOUNCEMENTS"||a==="MEMBERS"||a==="CONTACT"||a==="TESTIMONIALS"||a==="TIMELINE")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Subtitle"}),e.jsx(v,{value:t.subtitle||"",onChange:u=>j(i,"subtitle",u.target.value),placeholder:"Subtitle (e.g., date, position, role)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Description"}),e.jsx(he,{value:t.description||"",onChange:u=>j(i,"description",u.target.value),placeholder:"Item description",rows:3})]})]}),a==="STATS"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Value"}),e.jsx(v,{value:t.value||"",onChange:u=>j(i,"value",u.target.value),placeholder:"500+"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Label"}),e.jsx(v,{value:t.label||"",onChange:u=>j(i,"label",u.target.value),placeholder:"Active Panchayats"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Icon Name"}),e.jsx(v,{value:t.icon||"",onChange:u=>j(i,"icon",u.target.value),placeholder:"trending-up, users, building, etc."})]})]}),a==="FAQ"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Question"}),e.jsx(v,{value:t.title||"",onChange:u=>j(i,"title",u.target.value),placeholder:"Frequently asked question"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Answer"}),e.jsx(he,{value:t.description||"",onChange:u=>j(i,"description",u.target.value),placeholder:"Answer to the question",rows:4})]})]}),a==="TESTIMONIALS"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Rating (1-5)"}),e.jsx(v,{type:"number",min:"1",max:"5",value:t.value||"5",onChange:u=>j(i,"value",u.target.value)})]}),(a==="CTA"||a==="CARDS"||a==="FEATURES"||a==="SCHEMES")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Link URL"}),e.jsx(v,{value:t.link||"",onChange:u=>j(i,"link",u.target.value),placeholder:"/registration or https://..."})]}),(a==="FEATURES"||a==="NEWS"||a==="ANNOUNCEMENTS"||a==="SCHEMES"||a==="GALLERY"||a==="IMAGE_GALLERY"||a==="MEMBERS"||a==="CARDS"||a==="TESTIMONIALS"||a==="TIMELINE"||!a)&&a!=="CONTACT"&&a!=="STATS"&&a!=="FAQ"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Image"}),t.image?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Te,{src:t.image,alt:t.title||"Preview",className:"w-full h-32 rounded-lg",style:{objectFit:t.imageFit||"cover"}}),e.jsx(V,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{j(i,"image",""),L(i)},children:e.jsx(be,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:`item-image-fit-${i}`,className:"text-xs",children:"Image Display Style"}),e.jsxs(X,{value:t.imageFit||"cover",onValueChange:u=>j(i,"imageFit",u),children:[e.jsx(_,{id:`item-image-fit-${i}`,className:"h-9",children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"cover",children:"Cover - Fill container, may crop"}),e.jsx(f,{value:"contain",children:"Contain - Fit entire image, may have gaps"}),e.jsx(f,{value:"fill",children:"Fill - Stretch to fill container"}),e.jsx(f,{value:"none",children:"None - Original size"}),e.jsx(f,{value:"scale-down",children:"Scale Down - Like none or contain, whichever is smaller"})]})]})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-4 text-center",children:[e.jsx(Ne,{className:"h-6 w-6 mx-auto mb-2 text-muted-foreground"}),e.jsxs(c,{htmlFor:`item-image-${i}`,className:"cursor-pointer text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Click to upload"}),e.jsx(v,{id:`item-image-${i}`,type:"file",accept:"image/*",onChange:u=>W(u,i),className:"hidden"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:`item-image-fit-default-${i}`,className:"text-xs",children:"Image Display Style (applied after upload)"}),e.jsxs(X,{value:t.imageFit||"cover",onValueChange:u=>j(i,"imageFit",u),children:[e.jsx(_,{id:`item-image-fit-default-${i}`,className:"h-9",children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"cover",children:"Cover - Fill container, may crop"}),e.jsx(f,{value:"contain",children:"Contain - Fit entire image, may have gaps"}),e.jsx(f,{value:"fill",children:"Fill - Stretch to fill container"}),e.jsx(f,{value:"none",children:"None - Original size"}),e.jsx(f,{value:"scale-down",children:"Scale Down - Like none or contain, whichever is smaller"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose how the image should be displayed within its container"})]})]})]})]})]},i)};if(a==="HERO")return e.jsxs(Le,{value:I,onValueChange:q,className:"w-full",children:[e.jsxs(Fe,{className:"grid w-full grid-cols-3",children:[e.jsx(le,{value:"content",children:"Content"}),e.jsx(le,{value:"design",children:"Design"}),e.jsx(le,{value:"advanced",children:"Advanced"})]}),e.jsxs(re,{value:"content",className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hero sections use the section title, subtitle, and background image fields above. You can add additional content items below if needed."}),A.length>0&&e.jsx("div",{className:"space-y-4",children:A.map((t,i)=>se(t,i))}),e.jsxs(V,{type:"button",variant:"outline",onClick:h,children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Add Hero Item"]})]}),e.jsxs(re,{value:"design",className:"space-y-4",children:[e.jsx(Ve,{background:te,onChange:t=>{D(t),m({background:t})}}),e.jsx(De,{spacing:ne,onChange:t=>{oe(t),m({spacing:t})}})]}),e.jsxs(re,{value:"advanced",className:"space-y-4",children:[e.jsx(Ue,{animation:de,onChange:t=>{ce(t),m({animation:t})}}),e.jsx(Pe,{cta:ue,onChange:t=>{pe(t),m({cta:t})}})]})]});if(a==="RICH_TEXT")return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Rich Text Content (HTML)"}),e.jsx(he,{value:w,onChange:t=>{N(t.target.value),m({richText:t.target.value})},placeholder:"Enter HTML content or formatted text...",rows:10,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"You can use HTML tags for formatting. For example: <p>Paragraph</p>, <h2>Heading</h2>, <ul><li>List item</li></ul>"})]})});if(a==="FORM")return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Form Fields"}),e.jsx("div",{className:"space-y-4",children:d.map((t,i)=>e.jsx(je,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(c,{children:["Field ",i+1]}),e.jsx(V,{type:"button",variant:"ghost",size:"sm",onClick:()=>xe(i),className:"text-destructive",children:e.jsx(Ce,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Field Type"}),e.jsxs(X,{value:t.type,onValueChange:y=>J(i,{type:y}),children:[e.jsx(_,{children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"text",children:"Text"}),e.jsx(f,{value:"email",children:"Email"}),e.jsx(f,{value:"phone",children:"Phone"}),e.jsx(f,{value:"textarea",children:"Textarea"}),e.jsx(f,{value:"select",children:"Select"}),e.jsx(f,{value:"checkbox",children:"Checkbox"}),e.jsx(f,{value:"radio",children:"Radio"}),e.jsx(f,{value:"date",children:"Date"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Label"}),e.jsx(v,{value:t.label,onChange:y=>J(i,{label:y.target.value}),placeholder:"Field label"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Placeholder"}),e.jsx(v,{value:t.placeholder||"",onChange:y=>J(i,{placeholder:y.target.value}),placeholder:"Placeholder text"})]}),(t.type==="select"||t.type==="radio")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Options (comma-separated)"}),e.jsx(v,{value:t.options?.join(", ")||"",onChange:y=>J(i,{options:y.target.value.split(",").map(u=>u.trim())}),placeholder:"Option 1, Option 2, Option 3"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{id:`required-${t.id}`,checked:t.required,onCheckedChange:y=>J(i,{required:y})}),e.jsx(c,{htmlFor:`required-${t.id}`,className:"cursor-pointer",children:"Required field"})]})]})},t.id))}),e.jsxs(V,{type:"button",variant:"outline",onClick:H,children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Add Form Field"]})]})});if(a==="VIDEO"||a==="VIDEO_SECTION"){const t=u=>{if(!u.trim())return{isValid:!1,type:"invalid",message:"Please enter a video URL"};if(u.includes("youtube.com/watch")||u.includes("youtu.be/")||u.includes("youtube.com/embed/"))return u.match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([^&\n?#]+)/)?.[1]?{isValid:!0,type:"youtube"}:{isValid:!1,type:"invalid",message:"Invalid YouTube URL format"};if(u.includes("vimeo.com/"))return u.match(/vimeo\.com\/(\d+)/)?.[1]?{isValid:!0,type:"vimeo"}:{isValid:!1,type:"invalid",message:"Invalid Vimeo URL format"};if(u.match(/\.(mp4|webm|ogg|mov)(\?.*)?$/i))return{isValid:!0,type:"direct"};try{return new URL(u),{isValid:!0,type:"direct"}}catch{return{isValid:!1,type:"invalid",message:"Invalid URL format"}}},i=s?.media?.url||"",y=t(i);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"video-url",children:"Video URL *"}),e.jsx(v,{id:"video-url",value:i,onChange:u=>{const K=u.target.value;m({media:{...s?.media,url:K,type:"video"}})},placeholder:"https://www.youtube.com/watch?v=... or https://vimeo.com/... or https://example.com/video.mp4",className:y.isValid===!1&&i?"border-red-500":""}),i&&e.jsxs("div",{className:"text-xs space-y-1",children:[y.isValid?e.jsxs("p",{className:"text-green-600 flex items-center gap-1",children:[e.jsx("span",{children:"âœ“"})," Valid ",y.type==="youtube"?"YouTube":y.type==="vimeo"?"Vimeo":"video"," URL"]}):e.jsxs("p",{className:"text-red-600 flex items-center gap-1",children:[e.jsx("span",{children:"âœ—"})," ",y.message||"Invalid video URL"]}),e.jsx("p",{className:"text-muted-foreground",children:"Supported: YouTube (watch or embed URLs), Vimeo, or direct video links (.mp4, .webm, etc.)"})]})]}),y.isValid&&y.type!=="direct"&&e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Preview:"})," Your ",y.type==="youtube"?"YouTube":"Vimeo"," video will be embedded automatically."]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"video-thumbnail",children:"Thumbnail Image URL (optional)"}),e.jsx(v,{id:"video-thumbnail",value:s?.media?.thumbnail||"",onChange:u=>m({media:{...s?.media,thumbnail:u.target.value}}),placeholder:"https://example.com/thumbnail.jpg"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Custom thumbnail image (only used for direct video URLs)"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(c,{children:"Video Settings"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsx(ae,{id:"autoplay",checked:s?.media?.autoplay||!1,onCheckedChange:u=>m({media:{...s?.media,autoplay:u}})}),e.jsx(c,{htmlFor:"autoplay",className:"cursor-pointer text-sm",children:"Autoplay"})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsx(ae,{id:"loop",checked:s?.media?.loop||!1,onCheckedChange:u=>m({media:{...s?.media,loop:u}})}),e.jsx(c,{htmlFor:"loop",className:"cursor-pointer text-sm",children:"Loop"})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg",children:[e.jsx(ae,{id:"controls",checked:s?.media?.controls!==!1,onCheckedChange:u=>m({media:{...s?.media,controls:u}})}),e.jsx(c,{htmlFor:"controls",className:"cursor-pointer text-sm",children:"Show Controls"})]})]})]})]})}if(a==="MAP")return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Map Coordinates (latitude, longitude)"}),e.jsx(v,{value:s?.customSettings?.coordinates||"",onChange:t=>m({customSettings:{...s?.customSettings,coordinates:t.target.value}}),placeholder:"22.9734, 78.6569"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter coordinates in format: latitude, longitude"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Zoom Level"}),e.jsx(v,{type:"number",min:"1",max:"20",value:s?.customSettings?.zoom||15,onChange:t=>m({customSettings:{...s?.customSettings,zoom:parseInt(t.target.value)||15}})})]})]});const B=n==="GRID"&&(a==="FEATURES"||a==="SCHEMES"||a==="GALLERY"||a==="CARDS"||a==="STATS"||!a),$=n==="CAROUSEL";return e.jsxs(Le,{value:I,onValueChange:q,className:"w-full",children:[e.jsxs(Fe,{className:"grid w-full grid-cols-3",children:[e.jsx(le,{value:"content",children:"Content"}),e.jsx(le,{value:"design",children:"Design"}),e.jsx(le,{value:"settings",children:"Settings"})]}),e.jsxs(re,{value:"content",className:"space-y-4",children:[B&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Grid Columns"}),e.jsx(v,{type:"number",min:"1",max:"6",value:O,onChange:t=>{const i=parseInt(t.target.value)||3;l(i),m({columns:i})}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of columns in the grid layout (1-6)"})]}),e.jsx("div",{className:"space-y-4",children:A.map((t,i)=>se(t,i))}),e.jsxs(V,{type:"button",variant:"outline",onClick:h,children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Add ",a==="STATS"?"Stat":a==="FEATURES"?"Feature":a==="NEWS"?"News Item":a==="ANNOUNCEMENTS"?"Announcement":a==="SCHEMES"?"Scheme":a==="GALLERY"?"Gallery Item":a==="MEMBERS"?"Member":a==="CARDS"?"Card":a==="FAQ"?"FAQ Item":a==="TESTIMONIALS"?"Testimonial":a==="TIMELINE"?"Timeline Item":a==="CTA"?"CTA Item":a==="CONTACT"?"Contact Method":"Item"]})]}),e.jsxs(re,{value:"design",className:"space-y-4",children:[e.jsx(Ve,{background:te,onChange:t=>{D(t),m({background:t})}}),e.jsx(De,{spacing:ne,onChange:t=>{oe(t),m({spacing:t})}}),e.jsx(Ue,{animation:de,onChange:t=>{ce(t),m({animation:t})}})]}),e.jsxs(re,{value:"settings",className:"space-y-4",children:[$&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-blue-50 border-blue-200",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-base font-semibold",children:"Carousel Auto-Scroll Settings"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable automatic scrolling to advance through carousel items automatically"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{id:"autoplay",checked:S,onCheckedChange:t=>{p(t),m({autoPlay:t})}}),e.jsx(c,{htmlFor:"autoplay",className:"cursor-pointer font-medium",children:"Enable Auto-Scrolling"})]}),S&&e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx(c,{htmlFor:"carousel-interval",children:"Auto-Scroll Interval (milliseconds)"}),e.jsx(v,{id:"carousel-interval",type:"number",min:"1000",step:"500",value:g,onChange:t=>{const i=parseInt(t.target.value)||5e3;F(i),m({interval:i})}}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Time between automatic slides (minimum: 1000ms). Current: ",g,"ms (",Math.round(g/1e3)," seconds)"]})]})]}),e.jsx(Pe,{cta:ue,onChange:t=>{pe(t),m({cta:t})}})]})]})}function Ve({background:a,onChange:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{children:"Background"}),e.jsxs(X,{value:a.type,onValueChange:n=>s({...a,type:n}),children:[e.jsx(_,{children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"color",children:"Solid Color"}),e.jsx(f,{value:"gradient",children:"Gradient"}),e.jsx(f,{value:"image",children:"Image"}),e.jsx(f,{value:"video",children:"Video"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Value"}),a.type==="color"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{type:"color",value:a.value||"#ffffff",onChange:n=>s({...a,value:n.target.value}),className:"w-20 h-10"}),e.jsx(v,{value:a.value||"#ffffff",onChange:n=>s({...a,value:n.target.value}),placeholder:"#ffffff"})]}),(a.type==="gradient"||a.type==="image"||a.type==="video")&&e.jsx(v,{value:a.value||"",onChange:n=>s({...a,value:n.target.value}),placeholder:a.type==="gradient"?"linear-gradient(to right, #ff0000, #0000ff)":"URL"})]}),a.type==="image"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{id:"parallax",checked:a.parallax,onCheckedChange:n=>s({...a,parallax:n})}),e.jsx(c,{htmlFor:"parallax",className:"cursor-pointer",children:"Parallax Effect"})]}),a.overlay&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Overlay Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{type:"color",value:a.overlay.split(",")[0]||"#000000",onChange:n=>s({...a,overlay:`${n.target.value}, 0.5`}),className:"w-20 h-10"}),e.jsx(v,{type:"text",value:a.overlay,onChange:n=>s({...a,overlay:n.target.value}),placeholder:"rgba(0,0,0,0.5)"})]})]})]})}function De({spacing:a,onChange:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{children:"Spacing"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Padding"}),e.jsx(v,{type:"number",value:a.padding||0,onChange:n=>s({...a,padding:parseInt(n.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Margin"}),e.jsx(v,{type:"number",value:a.margin||0,onChange:n=>s({...a,margin:parseInt(n.target.value)||0})})]})]})]})}function Ue({animation:a,onChange:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{children:"Animation"}),e.jsxs(X,{value:a.type||"none",onValueChange:n=>s({...a,type:n}),children:[e.jsx(_,{children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"none",children:"None"}),e.jsx(f,{value:"fade-in",children:"Fade In"}),e.jsx(f,{value:"slide-in",children:"Slide In"}),e.jsx(f,{value:"zoom",children:"Zoom"})]})]}),a.type!=="none"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Delay (ms)"}),e.jsx(v,{type:"number",value:a.delay||0,onChange:n=>s({...a,delay:parseInt(n.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Duration (ms)"}),e.jsx(v,{type:"number",value:a.duration||500,onChange:n=>s({...a,duration:parseInt(n.target.value)||500})})]})]})]})}function Pe({cta:a,onChange:s}){return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{children:"Call-to-Action"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Button Text"}),e.jsx(v,{value:a.text,onChange:n=>s({...a,text:n.target.value}),placeholder:"Learn More"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Link URL"}),e.jsx(v,{value:a.link,onChange:n=>s({...a,link:n.target.value}),placeholder:"/registration or https://..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Style"}),e.jsxs(X,{value:a.style,onValueChange:n=>s({...a,style:n}),children:[e.jsx(_,{children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"primary",children:"Primary"}),e.jsx(f,{value:"secondary",children:"Secondary"}),e.jsx(f,{value:"outline",children:"Outline"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Size"}),e.jsxs(X,{value:a.size,onValueChange:n=>s({...a,size:n}),children:[e.jsx(_,{children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"sm",children:"Small"}),e.jsx(f,{value:"md",children:"Medium"}),e.jsx(f,{value:"lg",children:"Large"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Icon (optional)"}),e.jsx(v,{value:a.icon||"",onChange:n=>s({...a,icon:n.target.value}),placeholder:"arrow-right, check, etc."})]})]})}function qa({section:a,isPlatform:s=!1,onSave:n,onCancel:T,isOpen:E}){const[r,x]=C.useState({sectionType:a?.sectionType||"",title:a?.title||"",subtitle:a?.subtitle||"",content:a?.content||{},layoutType:a?.layoutType||"GRID",displayOrder:a?.displayOrder||0,isVisible:a?.isVisible!==void 0?a.isVisible:!0,backgroundColor:a?.backgroundColor||"",textColor:a?.textColor||"",imageUrl:a?.imageUrl||"",imageKey:a?.imageKey||"",imageFit:a?.imageFit||"cover",metadata:a?.metadata||{}}),[L,I]=C.useState(null),[q,A]=C.useState(null),[M,O]=C.useState([]),[l,S]=C.useState([]),[p,g]=C.useState(new Map),[F,w]=C.useState(!1),[N,te]=C.useState(null);C.useEffect(()=>{if(r.sectionType){const d=ha(He,r.sectionType);d?(console.log("Schema found for section type:",r.sectionType,d),te(d),(!r.layoutType||r.layoutType==="GRID")&&x(o=>({...o,layoutType:d.defaultLayout}))):(console.warn("No schema found for section type:",r.sectionType),te(null))}else te(null)},[r.sectionType]);const D=C.useMemo(()=>N?{supportsTitle:R(N,"supportsTitle"),supportsSubtitle:R(N,"supportsSubtitle"),supportsRichText:R(N,"supportsRichText"),supportsItems:R(N,"supportsItems"),supportsSingleImage:R(N,"supportsSingleImage"),supportsMultipleImages:R(N,"supportsMultipleImages"),supportedLayouts:N.supportedLayouts,defaultLayout:N.defaultLayout,supportsCTA:R(N,"supportsCTA"),supportsForm:R(N,"supportsForm"),supportsVideo:R(N,"supportsVideo"),supportsMap:R(N,"supportsMap"),supportsStatistics:R(N,"supportsStatistics"),supportsTimeline:R(N,"supportsTimeline"),supportsFAQ:R(N,"supportsFAQ"),supportsTestimonials:R(N,"supportsTestimonials"),supportsBackground:R(N,"supportsBackground"),supportsSpacing:R(N,"supportsSpacing"),supportsAnimation:R(N,"supportsAnimation"),itemSupportsImage:R(N,"itemSupportsImage"),itemSupportsLink:R(N,"itemSupportsLink"),itemSupportsIcon:R(N,"itemSupportsIcon"),itemSupportsValue:R(N,"itemSupportsValue"),itemSupportsRating:R(N,"itemSupportsRating")}:null,[N]);C.useEffect(()=>{if(a){console.log("Loading section data for editing:",{id:a.id,sectionType:a.sectionType,hasContent:!!a.content,contentType:typeof a.content});let d=a.content||{};if(typeof d=="string")try{d=JSON.parse(d),console.log("Parsed content from string:",d)}catch(m){console.warn("Failed to parse section content:",m),d={}}let o=a.metadata||{};if(typeof o=="string")try{o=JSON.parse(o)}catch(m){console.warn("Failed to parse section metadata:",m),o={}}const b=We(a.sectionType);console.log("Mapped section type:",a.sectionType,"->",b);const U={sectionType:b,title:a.title||"",subtitle:a.subtitle||"",content:d,layoutType:a.layoutType||"GRID",displayOrder:a.displayOrder??0,isVisible:a.isVisible!==void 0?a.isVisible:!0,backgroundColor:a.backgroundColor||"",textColor:a.textColor||"",imageUrl:a.imageUrl||"",imageKey:a.imageKey||"",imageFit:a.imageFit||"cover",metadata:o};if(console.log("Setting form data:",U),x(U),A(a.imageUrl||null),d&&typeof d=="object"&&Array.isArray(d.items)){const m=d.items.filter(h=>h.image);S(m.map(h=>h.image))}else S([])}else x({sectionType:"",title:"",subtitle:"",content:{},layoutType:"GRID",displayOrder:0,isVisible:!0,backgroundColor:"",textColor:"",imageUrl:"",imageKey:"",imageFit:"cover",metadata:{}}),A(null),S([]);I(null),O([]),console.log("ðŸ”„ Resetting contentItemImages Map (section or isOpen changed)",{sectionId:a?.id,isOpen:E}),g(new Map)},[a,E]);const ne=async d=>{const o=d.target.files?.[0];if(o)try{await ie(o),I(o);const b=new FileReader;b.onloadend=()=>{A(b.result)},b.readAsDataURL(o)}catch(b){console.error("Image validation failed:",b),G.error(b.message||"Invalid image file. Please select a valid image."),d.target.value=""}},oe=async d=>{const o=Array.from(d.target.files||[]);if(o.length===0)return;const b=[],U=[];for(const m of o)try{await ie(m),b.push(m)}catch(h){console.error(`Validation failed for ${m.name}:`,h),U.push(`${m.name}: ${h.message||"Invalid image file"}`)}if(U.length>0&&G.error(`Some files were rejected:
${U.join(`
`)}`),b.length===0){G.error("No valid image files selected. Please select valid image files."),d.target.value="";return}b.length<o.length&&G.warning(`${b.length} of ${o.length} files were accepted.`),O(m=>[...m,...b]),b.forEach(m=>{const h=new FileReader;h.onloadend=()=>{S(P=>[...P,h.result])},h.readAsDataURL(m)})},de=()=>{I(null),A(null),x({...r,imageUrl:"",imageKey:""})},ce=d=>{O(o=>o.filter((b,U)=>U!==d)),S(o=>o.filter((b,U)=>U!==d))},ue=()=>{O([]),S([])},pe=async d=>{if(d.preventDefault(),!r.sectionType){G.error("Please select a section type");return}console.log("ðŸš€ handleSubmit called - contentItemImages Map state:",{size:p.size,entries:Array.from(p.entries()).map(([o,b])=>({itemIndex:o,fileName:b.name,fileSize:b.size}))}),w(!0);try{let o=r.content||{};if(typeof o=="string")try{o=JSON.parse(o)}catch{o={}}M.length>0&&((!o.items||!Array.isArray(o.items))&&(o.items=[]),M.forEach((j,k)=>{o.items.push({id:`item-${Date.now()}-${k}`,title:`Image ${o.items.length+1}`,description:"",image:null})})),console.log("Before cleaning - contentItemImages Map:",{size:p.size,entries:Array.from(p.entries()).map(([j,k])=>({itemIndex:j,fileName:k.name,fileSize:k.size})),contentItems:o?.items?.map((j,k)=>({index:k,hasImage:!!j.image,image:j.image?.substring(0,50)||null}))||[]});const b=JSON.stringify(o);o=Ie(o);const U=JSON.stringify(o);r.sectionType==="IMAGE_WITH_TEXT"&&console.log("IMAGE_WITH_TEXT content cleaning:",{beforeCleanImage:JSON.parse(b)?.image,afterCleanImage:o?.image,imagePreserved:!!o?.image,contentType:typeof o,contentKeys:o&&typeof o=="object"?Object.keys(o):[]}),console.log("After cleaning - content items:",{items:o?.items?.map((j,k)=>({index:k,hasImage:!!j.image,image:j.image}))||[]});let m=r.metadata||{};if(typeof m=="string")try{m=JSON.parse(m)}catch{m={}}const h={sectionType:r.sectionType||a?.sectionType,layoutType:r.layoutType||a?.layoutType||"GRID",content:o,displayOrder:r.displayOrder??a?.displayOrder??0,isVisible:r.isVisible!==void 0?r.isVisible:a?.isVisible??!0,metadata:m};if(r.title!==void 0?h.title=r.title||null:a?.title!==void 0&&(h.title=a.title),r.subtitle!==void 0?h.subtitle=r.subtitle||null:a?.subtitle!==void 0&&(h.subtitle=a.subtitle),r.backgroundColor!==void 0?h.backgroundColor=r.backgroundColor||null:a?.backgroundColor!==void 0&&(h.backgroundColor=a.backgroundColor),r.textColor!==void 0?h.textColor=r.textColor||null:a?.textColor!==void 0&&(h.textColor=a.textColor),L?(h.imageFile=L,h.compressionQuality="HIGH",h.imageUrl=void 0,h.imageKey=void 0):r.imageUrl!==void 0?(h.imageUrl=r.imageUrl||null,h.imageKey=r.imageKey||null):a&&(h.imageUrl=a.imageUrl||null,h.imageKey=a.imageKey||null),r.imageFit!==void 0?h.imageFit=r.imageFit:a?.imageFit!==void 0&&(h.imageFit=a.imageFit),p.size>0){console.log(`Processing ${p.size} contentItemImages from Map`);const j=[],k=Array.from(p.entries()).sort((W,ee)=>W[0]-ee[0]),Q=o?.items||[];console.log(`Checking ${Q.length} items for null images`),k.forEach(([W,ee])=>{const H=Q[W],J=!H||!H.image||H.image===null||H.image===""||H.image==="null";console.log(`Item ${W}: hasNullImage=${J}, image=${H?.image||"null"}, fileName=${ee.name}`),J?(j.push(ee),console.log(`âœ“ Including image for item ${W}`)):console.log(`âœ— Skipping image for item ${W} (already has image: ${H?.image})`)}),j.length>0?(h.contentItemImages=j,h.compressionQuality="HIGH",console.log(`âœ… Sending ${j.length} contentItemImages to backend with compressionQuality: HIGH`)):console.warn("âš ï¸ No contentItemImages to send (all items already have images or Map is empty)")}else console.warn("âš ï¸ contentItemImages Map is empty (size=0)");console.log("Saving section:",{isUpdate:!!a,sectionId:a?.id,sectionType:h.sectionType,hasContent:!!h.content,contentItemsCount:h.content?.items?.length||0,hasImageFile:!!L,hasImageUrl:!!h.imageUrl,contentItemImagesCount:p.size,contentItemImagesToSend:h.contentItemImages?.length||0,contentItems:o?.items?.map((j,k)=>({index:k,hasImage:!!j.image,image:j.image}))||[],...h.sectionType==="IMAGE_WITH_TEXT"?{contentImage:h.content?.image,contentImageType:typeof h.content?.image,contentStringified:typeof h.content=="object"?JSON.stringify(h.content).substring(0,200):h.content?.substring(0,200)}:{}});const P=await n(h);if(console.log("Section saved successfully:",{sectionId:P.id,hasContent:!!P.content}),M.length>0&&P){const j=G.loading(`Uploading ${M.length} image(s)...`);try{const k=s?ve:fe,Q=s?ve:fe,W=P.imageUrl,ee=P.imageKey,H=[],J=M.map(async(B,$)=>{try{const i=(await k.uploadImage(P.id,B))?.imageUrl;if(!i)throw new Error(`Image upload failed: No imageUrl returned for image ${$+1}`);console.log(`Uploaded image ${$+1}, URL:`,i),H.push({index:$,imageUrl:i})}catch(t){throw console.error(`Error uploading image ${$+1}:`,t),t}});if(await Promise.all(J),W&&W!==null)try{await Q.updateSection(P.id,{imageUrl:W,imageKey:ee||void 0}),console.log("Restored original section image after multiple image uploads")}catch(B){console.warn("Failed to restore original section image after multiple image uploads:",B)}else try{await Q.updateSection(P.id,{imageUrl:void 0,imageKey:void 0}),console.log("Cleared section image after multiple image uploads")}catch(B){console.warn("Failed to clear section image after multiple image uploads:",B)}o.items||(o.items=[]);let xe=o.items.length-M.length;H.forEach(({index:B,imageUrl:$})=>{if(!$){console.warn(`Skipping null imageUrl for multiple image at index ${B}`);return}const t=xe+B;t>=0&&t<o.items.length&&o.items[t]?(console.log(`Setting image for multiple item at index ${t}:`,$),o.items[t].image=$):console.warn(`Item at index ${t} not found for multiple image ${B}. Total items: ${o.items.length}`)});const se=Ie({...o,items:o.items||[]});H.forEach(({index:B,imageUrl:$})=>{if(!$)return;const t=xe+B;t>=0&&t<se.items.length&&(se.items[t].image=$)}),await Q.updateSection(P.id,{content:se}),G.dismiss(j),G.success(`Successfully uploaded ${M.length} image(s)`)}catch(k){G.dismiss(j),console.error("Error uploading images:",k),G.error(`Failed to upload images: ${k.message||"Unknown error"}`)}}else{if(a){const j=Ie(o);if(JSON.stringify(j)!==JSON.stringify(o))try{await(s?ve:fe).updateSection(a.id,{content:j})}catch(Q){console.warn("Failed to clean content on update:",Q)}}G.success(a?"Section updated":"Section created")}}catch(o){G.error(o.message||"Failed to save section")}finally{w(!1)}};return E?(console.log("SectionEditor: Rendering form",{hasSection:!!a,sectionType:r.sectionType,hasSchema:!!N,hasSectionConfig:!!D}),e.jsxs("form",{onSubmit:pe,className:"space-y-6 p-6 bg-white rounded-lg",children:[!1,e.jsx(xa,{value:r.sectionType,onValueChange:d=>{console.log("Section type changed to:",d),x({...r,sectionType:d})},isPlatform:s}),(a||D&&(D.supportsTitle||D.supportsSubtitle))&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full",children:[(a||D&&D.supportsTitle)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"title",children:"Section Title"}),e.jsx(v,{id:"title",placeholder:"Section Title",value:r.title,onChange:d=>x({...r,title:d.target.value}),className:"w-full"})]}),(a||D&&D.supportsSubtitle)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"subtitle",children:"Section Subtitle"}),e.jsx(v,{id:"subtitle",placeholder:"Section Subtitle",value:r.subtitle,onChange:d=>x({...r,subtitle:d.target.value}),className:"w-full"})]})]}),N&&N.supportedLayouts.length>1&&e.jsx(va,{value:r.layoutType,onValueChange:d=>x({...r,layoutType:d}),supportedLayouts:N.supportedLayouts}),r.layoutType==="CAROUSEL"&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-blue-50 border-blue-200",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-base font-semibold",children:"Carousel Auto-Scroll Settings"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure automatic scrolling behavior for the carousel"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{id:"carousel-auto-scroll",checked:r.content?.autoPlay||!1,onCheckedChange:d=>{const o={...r.content,autoPlay:d};x({...r,content:o})}}),e.jsx(c,{htmlFor:"carousel-auto-scroll",className:"cursor-pointer font-medium",children:"Enable Auto-Scrolling"})]}),r.content?.autoPlay&&e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx(c,{htmlFor:"carousel-interval",children:"Auto-Scroll Interval (milliseconds)"}),e.jsx(v,{id:"carousel-interval",type:"number",min:"1000",step:"500",value:r.content?.interval||5e3,onChange:d=>{const o={...r.content,interval:parseInt(d.target.value)||5e3};x({...r,content:o})},className:"w-full"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Time between automatic slides (minimum: 1000ms). Current: ",r.content?.interval||5e3,"ms"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Content"}),r.sectionType?N?e.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:e.jsx(qe,{sectionType:r.sectionType,content:r.content,layoutType:r.layoutType,isPlatform:s,schema:N,onContentChange:d=>x({...r,content:d}),onImageUpload:async(d,o)=>{try{console.log(`ðŸ“¸ onImageUpload called for item ${o}:`,{fileName:d.name,fileSize:d.size,fileType:d.type}),await ie(d),g(U=>{const m=new Map(U);return m.set(o,d),console.log(`âœ… Stored file in Map for item ${o}. Map size now: ${m.size}`,{mapEntries:Array.from(m.entries()).map(([h,P])=>({itemIndex:h,fileName:P.name}))}),m});const b=await Re(d);return console.log(`âœ… Generated preview URL for item ${o}`),b}catch(b){return console.error("âŒ Error preparing image upload:",b),G.error(b.message||"Invalid image file. Please select a valid image."),null}},onImageRemove:d=>{g(o=>{const b=new Map(o);return b.delete(d),b})}})}):e.jsxs("div",{className:"border rounded-lg p-4 bg-yellow-50 border-yellow-200",children:[e.jsxs("p",{className:"text-sm text-yellow-800 mb-2",children:["âš ï¸ No schema found for section type: ",e.jsx("strong",{children:r.sectionType})]}),e.jsx("p",{className:"text-xs text-yellow-700 mb-4",children:"The section type exists but no schema configuration is available. You can still edit the content manually below."}),e.jsx("div",{className:"mt-4 border rounded-lg p-4 bg-white",children:e.jsx(qe,{sectionType:r.sectionType,content:r.content,layoutType:r.layoutType,isPlatform:s,schema:null,onContentChange:d=>x({...r,content:d}),onImageUpload:async(d,o)=>{try{console.log(`ðŸ“¸ onImageUpload called for item ${o}:`,{fileName:d.name,fileSize:d.size,fileType:d.type}),await ie(d),g(U=>{const m=new Map(U);return m.set(o,d),console.log(`âœ… Stored file in Map for item ${o}. Map size now: ${m.size}`,{mapEntries:Array.from(m.entries()).map(([h,P])=>({itemIndex:h,fileName:P.name}))}),m});const b=await Re(d);return console.log(`âœ… Generated preview URL for item ${o}`),b}catch(b){return console.error("âŒ Error preparing image upload:",b),G.error(b.message||"Invalid image file. Please select a valid image."),null}},onImageRemove:d=>{g(o=>{const b=new Map(o);return b.delete(d),b})}})})]}):e.jsxs("div",{className:"border rounded-lg p-4 text-center text-gray-500",children:[e.jsx("p",{className:"mb-2",children:"Please select a section type above"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Once you select a section type, the content editor will appear here"})]})]}),D&&D.supportsBackground&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 w-full",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"background-color",children:"Background Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{id:"background-color",type:"color",value:r.backgroundColor||"#ffffff",onChange:d=>x({...r,backgroundColor:d.target.value}),className:"w-20 h-10"}),e.jsx(v,{placeholder:"#ffffff or CSS color",value:r.backgroundColor,onChange:d=>x({...r,backgroundColor:d.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"text-color",children:"Text Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{id:"text-color",type:"color",value:r.textColor||"#000000",onChange:d=>x({...r,textColor:d.target.value}),className:"w-20 h-10"}),e.jsx(v,{placeholder:"#000000 or CSS color",value:r.textColor,onChange:d=>x({...r,textColor:d.target.value})})]})]})]}),D&&D.supportsSingleImage&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(c,{children:"Section Image"}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Upload a single image for the section header/background"}),q?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Te,{src:q,alt:"Preview",className:"w-full h-48 rounded-lg",style:{objectFit:r.imageFit}}),e.jsx(V,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:de,children:e.jsx(be,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"image-fit",children:"Image Display Style"}),e.jsxs(X,{value:r.imageFit,onValueChange:d=>x({...r,imageFit:d}),children:[e.jsx(_,{id:"image-fit",children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"cover",children:"Cover - Fill container, may crop"}),e.jsx(f,{value:"contain",children:"Contain - Fit entire image, may have gaps"}),e.jsx(f,{value:"fill",children:"Fill - Stretch to fill container"}),e.jsx(f,{value:"none",children:"None - Original size"}),e.jsx(f,{value:"scale-down",children:"Scale Down - Like none or contain, whichever is smaller"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose how the image should be displayed within its container"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center",children:[e.jsx(Ne,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsxs(c,{htmlFor:"image-upload",className:"cursor-pointer",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Click to upload image"}),e.jsx(v,{id:"image-upload",type:"file",accept:"image/*",onChange:ne,className:"hidden"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"image-fit-default",children:"Image Display Style (applied after upload)"}),e.jsxs(X,{value:r.imageFit,onValueChange:d=>x({...r,imageFit:d}),children:[e.jsx(_,{id:"image-fit-default",children:e.jsx(z,{})}),e.jsxs(Y,{children:[e.jsx(f,{value:"cover",children:"Cover - Fill container, may crop"}),e.jsx(f,{value:"contain",children:"Contain - Fit entire image, may have gaps"}),e.jsx(f,{value:"fill",children:"Fill - Stretch to fill container"}),e.jsx(f,{value:"none",children:"None - Original size"}),e.jsx(f,{value:"scale-down",children:"Scale Down - Like none or contain, whichever is smaller"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose how the image should be displayed within its container"})]})]})]})}),D&&D.supportsMultipleImages&&r.sectionType!=="IMAGE_GALLERY"&&r.sectionType!=="GALLERY"&&e.jsxs("div",{children:[e.jsx(c,{children:"Multiple Images (for Content Items)"}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Upload multiple images for content items. These will be added as new items."}),l.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-4",children:l.map((d,o)=>e.jsxs("div",{className:"relative",children:[e.jsx(Te,{src:d,alt:`Preview ${o+1}`,className:"w-full h-32 object-cover rounded-lg"}),e.jsx(V,{type:"button",variant:"destructive",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0",onClick:()=>ce(o),children:e.jsx(be,{className:"h-3 w-3"})})]},o))}),e.jsx(V,{type:"button",variant:"outline",size:"sm",onClick:ue,className:"mb-2",children:"Clear All Images"})]}),e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center",children:[e.jsx(Ne,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsxs(c,{htmlFor:"multiple-image-upload",className:"cursor-pointer",children:[e.jsx("span",{className:"text-sm text-gray-500",children:l.length>0?`Add more images (${l.length} selected)`:"Click to upload multiple images"}),e.jsx(v,{id:"multiple-image-upload",type:"file",accept:"image/*",multiple:!0,onChange:oe,className:"hidden"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"metadata",children:"Metadata (Advanced)"}),e.jsx(he,{id:"metadata",placeholder:'{"columns": 3, "autoPlay": true}',value:typeof r.metadata=="string"?r.metadata:JSON.stringify(r.metadata,null,2),onChange:d=>{try{const o=JSON.parse(d.target.value);x({...r,metadata:o})}catch{x({...r,metadata:d.target.value})}},rows:4,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Optional JSON for advanced configuration"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"display-order",children:"Display Order"}),e.jsx(v,{id:"display-order",type:"number",value:r.displayOrder,onChange:d=>x({...r,displayOrder:parseInt(d.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"is-visible",children:"Visibility"}),e.jsxs("select",{id:"is-visible",value:r.isVisible?"true":"false",onChange:d=>x({...r,isVisible:d.target.value==="true"}),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm",children:[e.jsx("option",{value:"true",children:"Visible"}),e.jsx("option",{value:"false",children:"Hidden"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(V,{type:"button",variant:"outline",onClick:T,className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(V,{type:"submit",disabled:F,className:"w-full sm:w-auto",children:F?"Saving...":a?"Update":"Create"})]})]})):(console.log("SectionEditor: isOpen is false, not rendering"),null)}export{ka as C,aa as G,qa as S};
